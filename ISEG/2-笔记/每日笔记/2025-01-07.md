根据两篇文章的内容，可以提取计算**对象耦合度（CBO）**、**公共元素访问（CEA）**和**词汇相似度（Lexical Similarity）**的详细方法。
**1. 对象耦合度（CBO）**

  

CBO用于衡量类之间的相互依赖程度，具体计算方式如下：

• 定义：CBO是一个类访问另一个类的成员数量的度量，同时包括反向的访问。

• 计算方法：

1. 对于类A和类B，统计类A访问类B的成员（包括字段、方法）的数量。

2. 统计类B访问类A的成员的数量。

3. 将以上两者相加，得到类A和B之间的CBO值。

  

举例：如果类A访问了类B的3个方法，而类B访问了类A的2个字段，则两者的CBO为3+2=5 。

  

**2. 公共元素访问（CEA）**

  

CEA用于捕获两个类对外部共享资源的依赖关系，计算方式如下：

• 定义：CEA是两个类共同访问的外部类成员的数量。

• 计算方法：

1. 识别类A访问的所有外部类的成员。

2. 识别类B访问的所有外部类的成员。

3. 找出两者的交集，即共同访问的成员数量。

  

举例：如果类A和类B都访问了类C的两个字段和一个方法，则CEA为3。

  

注意：CEA专注于外部类的共享访问，因此与直接依赖的CBO不同。

  

**3. 词汇相似度（Lexical Similarity）**

  

词汇相似度用于衡量类名称之间的相似性，通常基于名称中的共享词汇。

• 定义：词汇相似度是类名之间共享词的数量的归一化计数。

• 计算方法：

1. 将类名拆分为单词。例如，类名DataManager被分割为Data和Manager。

2. 计算两个类名中的共享词数。

3. 将共享词数归一化为总词数。例如，如果类UserManager和类ManagerService的共享词为Manager，总词数为4，则词汇相似度为1/4 = 0.25。

  

**数据来源及局限**

  

根据文章【11】，CBO和CEA的计算依赖于数据集中的代码快照（如编辑事件EditEvent和补全事件CompletionEvent），如果这些事件不完整，可能会导致计算误差。同样，词汇相似度在类名命名不规范或采用不同命名风格时可能失准。

  

如果您需要进一步的详细分析或具体代码实现，请告诉我！

# 数据收集工具


分别编译打包出了可以在windows和macos上运行的定制内核vscode。
主要改动：添加了用于收集指令的api，并将其暴露出来供插件使用，从而完整的收集用户通过点击vscode内菜单、按钮、使用快捷键等触发相关指令的操作。

将插件移植到新的定制内核vscode上，并发布了新的release。
![[Pasted image 20250108184101.png]]


# 分析数据

两个仓库：`management-service_0.1.0` 和 `user-content-service_0.1.0`。

## 总体数据

统计2大部分：Event(事件) 和 Artifact(工件)
红框是细化后的命令。

![[Pasted image 20241228193423.png]]


共3047条数据，其中2043条包含reference字段，**35条有内容**，可用于计算对象耦合度（CBO）、公共元素访问（CEA）和词汇相似度（Lexical Similarity）。

reference有内容的数据，对应的eventType有：SelectText和MouseHover；artifactType有：Class和Function。

复现了论文中提到的指标：
1. **CBO (Coupling Between Objects)**: 类与类之间的耦合度。
2. **CEA (Common Elements Accessed)**: 两个类之间共享的元素数量。
3. **词汇相似度 (Lexical Similarity)**: 类名之间的相似度，通过词汇分解计算









