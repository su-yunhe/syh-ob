数据结构定义在`base/log_item.py`里。
```bash
labels:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
acc: 0.9552
----------
preds:  tensor([0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
labels:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
acc: 0.9851
----------
preds:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
labels:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
acc: 1.0000
----------
preds:  tensor([0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
labels:  tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])
acc: 0.9552
----------
preds:  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
labels:  tensor([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
acc: 0.6269
----------
preds:  tensor([0, 2, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2])
labels:  tensor([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
acc: 0.1493
----------
preds:  tensor([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        0, 0, 0, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0])
labels:  tensor([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
acc: 0.9104
----------
preds:  tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
labels:  tensor([2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
        2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2])
acc: 0.6567
----------
Mean acc: 0.7823
(VirtualMe) suyunhe25@dell-gpu-02:~/virtual
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-ba
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 7, in <module>
    from gensim.models import Word2Vec
ModuleNotFoundError: No module named 'gensim'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ pip install gensim
Collecting gensim
  Downloading gensim-4.3.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.2 kB)
Collecting numpy<2.0,>=1.18.5 (from gensim)
  Downloading numpy-1.26.4-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (61 kB)
Collecting scipy<1.14.0,>=1.7.0 (from gensim)
  Downloading scipy-1.13.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (60 kB)
Collecting smart-open>=1.8.1 (from gensim)
  Downloading smart_open-7.0.5-py3-none-any.whl.metadata (24 kB)
Collecting wrapt (from smart-open>=1.8.1->gensim)
  Downloading wrapt-1.17.0-cp310-cp310-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.4 kB)
Downloading gensim-4.3.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (26.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 0.0/26.5 MB ? eta -:--:--
ERROR: Exception:
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 438, in _error_catcher
    yield
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 561, in read
    data = self._fp_read(amt) if not fp_closed else b""
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 527, in _fp_read
    return self._fp.read(amt) if amt is not None else self._fp.read()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/cachecontrol/filewrapper.py", line 98, in read
    data: bytes = self.__fp.read(amt)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/http/client.py", line 466, in read
    s = self.fp.read(amt)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/socket.py", line 717, in readinto
    return self._sock.recv_into(b)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/ssl.py", line 1307, in recv_into
    return self.read(nbytes, buffer)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/ssl.py", line 1163, in read
    return self._sslobj.read(len, buffer)
TimeoutError: The read operation timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/cli/base_command.py", line 105, in _run_wrapper
    status = _inner_run()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/cli/base_command.py", line 96, in _inner_run
    return self.run(options, args)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/cli/req_command.py", line 67, in wrapper
    return func(self, options, args)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/commands/install.py", line 379, in run
    requirement_set = resolver.resolve(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/resolution/resolvelib/resolver.py", line 179, in resolve
    self.factory.preparer.prepare_linked_requirements_more(reqs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/operations/prepare.py", line 554, in prepare_linked_requirements_more
    self._complete_partial_requirements(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/operations/prepare.py", line 469, in _complete_partial_requirements
    for link, (filepath, _) in batch_download:
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/network/download.py", line 184, in __call__
    for chunk in chunks:
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/cli/progress_bars.py", line 55, in _rich_progress_bar
    for chunk in iterable:
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_internal/network/utils.py", line 65, in response_chunks
    for chunk in response.raw.stream(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 622, in stream
    data = self.read(amt=amt, decode_content=decode_content)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 560, in read
    with self._error_catcher():
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/contextlib.py", line 153, in __exit__
    self.gen.throw(typ, value, traceback)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pip/_vendor/urllib3/response.py", line 443, in _error_catcher
    raise ReadTimeoutError(self._pool, None, "Read timed out.")
pip._vendor.urllib3.exceptions.ReadTimeoutError: HTTPSConnectionPool(host='files.pythonhosted.org', port=443): Read timed out.
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ conda install gensim
Retrieving notices: ...working... done
Channels:
 - defaults
Platform: linux-64
Collecting package metadata (repodata.json): done
Solving environment: done

## Package Plan ##

  environment location: /home/LAB/suyunhe25/anaconda3/envs/VirtualMe

  added / updated specs:
    - gensim


The following packages will be downloaded:

    package                    |            build
    ---------------------------|-----------------
    gensim-4.3.3               |  py310h1128e8f_0        42.3 MB
    libgfortran-ng-11.2.0      |       h00389a5_1          20 KB
    numpy-1.26.4               |  py310h5f9d8c6_0          11 KB
    numpy-base-1.26.4          |  py310hb5e798b_0         7.2 MB
    pybind11-abi-4             |       hd3eb1b0_1          14 KB
    scipy-1.13.1               |  py310h5f9d8c6_0        22.1 MB
    smart_open-5.2.1           |  py310h06a4308_0          76 KB
    ------------------------------------------------------------
                                           Total:        71.7 MB

The following NEW packages will be INSTALLED:

  gensim             pkgs/main/linux-64::gensim-4.3.3-py310h1128e8f_0 
  libgfortran-ng     pkgs/main/linux-64::libgfortran-ng-11.2.0-h00389a5_1 
  libgfortran5       pkgs/main/linux-64::libgfortran5-11.2.0-h1234567_1 
  pybind11-abi       pkgs/main/noarch::pybind11-abi-4-hd3eb1b0_1 
  scipy              pkgs/main/linux-64::scipy-1.13.1-py310h5f9d8c6_0 
  smart_open         pkgs/main/linux-64::smart_open-5.2.1-py310h06a4308_0 

The following packages will be DOWNGRADED:

  numpy                               2.0.1-py310h5f9d8c6_1 --> 1.26.4-py310h5f9d8c6_0 
  numpy-base                          2.0.1-py310hb5e798b_1 --> 1.26.4-py310hb5e798b_0 


Proceed ([y]/n)? y


Downloading and Extracting Packages:
                                                                                                                                                                          
Preparing transaction: done                                                                                                                                               
Verifying transaction: done                                                                                                                                               
Executing transaction: done                                                                                                                                               
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py                                                                        
Traceback (most recent call last):                                                                                                                                        
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 8, in <module>
    from base import Log, LogItem, EventType, TaskType, ArtifactType, ContextType
ModuleNotFoundError: No module named 'base'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 13, in <module>
    from base import Log, LogItem, EventType, TaskType, ArtifactType, ContextType
ModuleNotFoundError: No module named 'base'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 215, in <module>
    dataset_x, dataset_y = generate_data(pt_file, max_seq_len)
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 170, in generate_data
    encode_artifact(item.artifact, embedding_model) +
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 123, in encode_artifact
    float(max(r.count for r in artifact.reference)) if artifact.reference else 0.0  # 最大引用计数
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/dataset.py", line 123, in <genexpr>
    float(max(r.count for r in artifact.reference)) if artifact.reference else 0.0  # 最大引用计数
AttributeError: type object 'Artifact' has no attribute 'count'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py
Dataset X shape: torch.Size([1, 67, 175])
Dataset Y shape: torch.Size([1, 67])
Number of sequences: 1
Feature dimension: 175
Number of task types: 5
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/dataset.py
Dataset X shape: torch.Size([1, 67, 185])
Dataset Y shape: torch.Size([1, 67])
Number of sequences: 1
Feature dimensions:
- EventType: 21
- Artifact: 144
- Context: 21
Total: 186
Number of task types: 5
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 8, in <module>
    from config import train_params, model_params
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/config.py", line 3, in <module>
    from base.log_item import TaskType
ModuleNotFoundError: No module named 'base'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 8, in <module>
    from config import train_params, model_params
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/config.py", line 2, in <module>
    PROJECT_ROOT = os.path.dirname(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
NameError: name 'os' is not defined
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py
Dataset X shape: torch.Size([1, 67, 185])
Dataset Y shape: torch.Size([1, 67])
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/dataset.py:473: UserWarning: Length of split at index 0 is 0. This might result in an empty dataset.
  warnings.warn(
Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 35, in <module>
    train_dataloader = torch.utils.data.DataLoader(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 376, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/sampler.py", line 164, in __init__
    raise ValueError(
ValueError: num_samples should be a positive integer value, but got num_samples=0
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py
^C

Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 1, in <module>
    import torch
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/__init__.py", line 367, in <module>
    from torch._C import *  # noqa: F403
  File "<frozen importlib._bootstrap>", line 216, in _lock_unlock_module
KeyboardInterrupt

(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ 
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ 
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py
Found 10 pt files in dataset
Processing 2024-12-09 19 copy 8.pt...
Processing 2024-12-09 19 copy 5.pt...
Processing 2024-12-09 19 copy.pt...
Processing 2024-12-09 19 copy 7.pt...
Processing 2024-12-09 19 copy 2.pt...
Processing 2024-12-09 19.pt...
Processing 2024-12-09 19 copy 6.pt...
Processing 2024-12-09 19 copy 3.pt...
Processing 2024-12-09 19 copy 9.pt...
Processing 2024-12-09 19 copy 4.pt...
Dataset X shape: torch.Size([10, 67, 185])
Dataset Y shape: torch.Size([10, 67])
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python pattern_recognition/cfc/train.py ...
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/LAB/suyunhe25/virtualme-backend/ckpt/cfc/version_1 exists and is not empty.

  | Name  | Type | Params | Mode 
---------------------------------------
0 | model | CfC  | 127 K  | train
---------------------------------------
102 K     Trainable params
25.5 K    Non-trainable params
127 K     Total params
0.511     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loggers/tensorboard.py:191: Could not log computational graph to TensorBoard: The `model.example_input_array` attribute is not set or `input_array` was not given.
Sanity Checking DataLoader 0:   0%|                                                                                              | 0/1 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 97, in <module>
    trainer.fit(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/learner.py", line 39, in validation_step
    loss = nn.CrossEntropyLoss()(y_hat, y)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1736, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1747, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/nn/modules/loss.py", line 1293, in forward
    return F.cross_entropy(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/nn/functional.py", line 3479, in cross_entropy
    return torch._C._nn.cross_entropy_loss(
RuntimeError: Expected target size [2, 5], got [2]
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py                                                         
Found 10 pt files in dataset
Processing 2024-12-09 19 copy 8.pt...
Processing 2024-12-09 19 copy 5.pt...
Processing 2024-12-09 19 copy.pt...
Processing 2024-12-09 19 copy 7.pt...
Processing 2024-12-09 19 copy 2.pt...
Processing 2024-12-09 19.pt...
Processing 2024-12-09 19 copy 6.pt...
Processing 2024-12-09 19 copy 3.pt...
Processing 2024-12-09 19 copy 9.pt...
Processing 2024-12-09 19 copy 4.pt...
Dataset X shape: torch.Size([10, 67, 185])
Dataset Y shape: torch.Size([10, 67])
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python pattern_recognition/cfc/train.py ...
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/LAB/suyunhe25/virtualme-backend/ckpt/cfc/version_1 exists and is not empty.

  | Name  | Type | Params | Mode 
---------------------------------------
0 | model | CfC  | 127 K  | train
---------------------------------------
102 K     Trainable params
25.5 K    Non-trainable params
127 K     Total params
0.511     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loggers/tensorboard.py:191: Could not log computational graph to TensorBoard: The `model.example_input_array` attribute is not set or `input_array` was not given.
Sanity Checking DataLoader 0:   0%|                                                                                              | 0/1 [00:00<?, ?it/s]Traceback (most recent call last):
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/train.py", line 97, in <module>
    trainer.fit(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 538, in fit
    call._call_and_handle_interrupt(
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 47, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 574, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 981, in _run
    results = self._run_stage()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1023, in _run_stage
    self._run_sanity_check()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/trainer.py", line 1052, in _run_sanity_check
    val_loop.run()
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/utilities.py", line 178, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 135, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 396, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/trainer/call.py", line 319, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/strategies/strategy.py", line 411, in validation_step
    return self.lightning_module.validation_step(*args, **kwargs)
  File "/home/LAB/suyunhe25/virtualme-backend/pattern_recognition/cfc/learner.py", line 41, in validation_step
    y_hat = y_hat.view(-1, y_hat.size(-1))  # [batch_size * seq_len, num_classes]
AttributeError: 'tuple' object has no attribute 'view'
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ python pattern_recognition/cfc/train.py                                                         
Found 10 pt files in dataset
Processing 2024-12-09 19 copy 8.pt...
Processing 2024-12-09 19 copy 5.pt...
Processing 2024-12-09 19 copy.pt...
Processing 2024-12-09 19 copy 7.pt...
Processing 2024-12-09 19 copy 2.pt...
Processing 2024-12-09 19.pt...
Processing 2024-12-09 19 copy 6.pt...
Processing 2024-12-09 19 copy 3.pt...
Processing 2024-12-09 19 copy 9.pt...
Processing 2024-12-09 19 copy 4.pt...
Dataset X shape: torch.Size([10, 67, 185])
Dataset Y shape: torch.Size([10, 67])
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/lightning_fabric/plugins/environments/slurm.py:204: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python pattern_recognition/cfc/train.py ...
GPU available: False, used: False
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/callbacks/model_checkpoint.py:654: Checkpoint directory /home/LAB/suyunhe25/virtualme-backend/ckpt/cfc/version_1 exists and is not empty.

  | Name  | Type | Params | Mode 
---------------------------------------
0 | model | CfC  | 127 K  | train
---------------------------------------
102 K     Trainable params
25.5 K    Non-trainable params
127 K     Total params
0.511     Total estimated model params size (MB)
24        Modules in train mode
0         Modules in eval mode
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loggers/tensorboard.py:191: Could not log computational graph to TensorBoard: The `model.example_input_array` attribute is not set or `input_array` was not given.
/home/LAB/suyunhe25/anaconda3/envs/VirtualMe/lib/python3.10/site-packages/pytorch_lightning/loops/fit_loop.py:298: The number of training batches (1) is smaller than the logging interval Trainer(log_every_n_steps=5). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:01<00:00,  0.87it/s, v_num=1]Metric val_acc improved. New best score: 0.448                                                                                                         
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.61it/s, v_num=1]Metric val_acc improved by 0.358 >= min_delta = 0.0. New best score: 0.806                                                                             
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.63it/s, v_num=1]Metric val_acc improved by 0.045 >= min_delta = 0.0. New best score: 0.851                                                                             
Epoch 4: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.64it/s, v_num=1]Metric val_acc improved by 0.045 >= min_delta = 0.0. New best score: 0.896                                                                             
Epoch 5: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.59it/s, v_num=1]Metric val_acc improved by 0.030 >= min_delta = 0.0. New best score: 0.925                                                                             
Epoch 6: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.61it/s, v_num=1]Metric val_acc improved by 0.015 >= min_delta = 0.0. New best score: 0.940                                                                             
Epoch 8: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.62it/s, v_num=1]Metric val_acc improved by 0.015 >= min_delta = 0.0. New best score: 0.955                                                                             
Epoch 16: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.64it/s, v_num=1]Metric val_acc improved by 0.015 >= min_delta = 0.0. New best score: 0.970                                                                             
Epoch 24: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.63it/s, v_num=1]Metric val_acc improved by 0.015 >= min_delta = 0.0. New best score: 0.985                                                                             
Epoch 33: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.64it/s, v_num=1]Metric val_acc improved by 0.015 >= min_delta = 0.0. New best score: 1.000                                                                          
Epoch 53: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.63it/s, v_num=1]Monitored metric val_acc did not improve in the last 20 records. Best score: 1.000. Signaling Trainer to stop.                              
Epoch 53: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  2.62it/s, v_num=1]
Best validation accuracy: 1.0000
(VirtualMe) suyunhe25@dell-gpu-02:~/virtualme-backend$ 
```